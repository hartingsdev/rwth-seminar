% This is samplepaper.tex, a sample chapter demonstrating the
% LLNCS macro package for Springer Computer Science proceedings;
% Version 2.20 of 2017/10/04
%
\documentclass[runningheads]{llncs}
% Add your own packages here
\usepackage{graphicx}
%
\begin{document}
%
\title{Hardware Security Tokens In Context Of FIDO2}
\subtitle{Seminar: Advances in Cryptography and IT-Security}
%
%\titlerunning{Abbreviated paper title}
% If the paper title is too long for the running head, you can set
% an abbreviated paper title here
%

\author{Robert Hartings}

\institute{
\today \\
RWTH Aachen \\
Research Group IT-Security \\[.8cm]
\begin{tabular}{rl}
  \textbf{Organizer:}& Ulrike Meyer\\
  \textbf{Supervisor:}& Vincent Drury\\
\end{tabular}
%\date{01 Apr 2019}
}
%
\maketitle              % typeset the header of the contribution
%
\begin{abstract}
The abstract should briefly summarize the contents of the paper in
150--250 words. ullamcorper eget nulla facilisi etiam dignissim diam quis enim lobortis scelerisque fermentum dui faucibus in ornare quam viverra orci sagittis eu volutpat odio facilisis mauris sit amet massa vitae tortor condimentum lacinia quis vel eros donec ac odio tempor orci dapibus ultrices in iaculis nunc sed augue lacus viverra vitae congue eu consequat ac felis donec et odio pellentesque diam volutpat commodo sed egestas egestas fringilla phasellus faucibus scelerisque eleifend donec pretium vulputate sapien nec sagittis aliquam malesuada bibendum arcu vitae elementum curabitur vitae nunc sed velit dignissim sodales ut eu sem integer vitae justo eget magna fermentum iaculis eu non diam phasellus vestibulum lorem sed risus ultricies tristique nulla aliquet enim tortor at auctor urna nunc id cursus metus aliquam eleifend mi in nulla posuere sollicitudin aliquam ultrices sagittis orci a scelerisque purus semper eget duis at tellus at urna condimentum mattis pellentesque id nibh tortor id aliquet lectus proin nibh nisl condimentum id venenatis a condimentum vitae sapien pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas sed tempus urna et pharetra pharetra massa

\end{abstract}
%
%
%
\section{Introduction}
Credentials with username and password are still the most common variant of user authentication today, despite their problems with phishing or dictionary attacks, for example. To create secure accounts, it is recommended to use strong passwords (including capital and lower letters, numbers and speical characters and a minimum length) while refraning from reuse. The user has to memorize these rather complex different passwords or use a password manager which has its own disadvanteages. If credentials are reused on multiple accounts, they are vulnerable to credential stuffing attacks, in which an attacker uses stolen credentials from one service on other services hoping for same or similar credentials, making it easier for him to guess the right combination of username/email and password. Username and password are always vulnerable to phishing, because it cannot be ruled out that even the most experienced user will make a mistake and enters thier credentials on an website owned by an attacker.

This problem is challenge by the FIDO Alliance and the W3C by providing a possible solution: The Fast Identity Online 2 (FIDO2) standard. The main difference between the proposed standard and status quo is the paradigm shift from "something a user knows" to "something a user poses". The FIDO2 standard includes a successor to the Universal 2nd Factor (U2F), which was also developed by the FIDO Alliance and, in addition to the familiar Second Factor, also offers the possibility for Single Factor Authentication, making password as we know them superfluous. The cost, inconvenience and unfamiliarity of (hardware) security keys are currently reason for thier low uptake.\cite{274547}\cite{9152694}

But like other authentication variants, FIDO2 has its own unsolved problems and drawbacks. In this paper I would like to summarize these problems and possible solutions. 

\section{Background}
\subsection{Hardware Secruity Tokens (HSTs)}
HSTs are used to securly store a secret key used for cryptographic functions in a tamper-resistant storage. The main idea is that the secret never leaves the secure storage. The secret key is used for deriving subsequent authentication keys for creation of public / private identities. The derived keys are mainly used to sign recived challenges, but can also be used to identiy a user.\cite{272198}

HST, also called authenticators, can be so called security keys but also integrated authenticators including Trusted Platform Module (TPM), Andriod keystore and Apple TouchID. Microsoft Hello is one example for the TPM.

Security keys from vendors like Yubico (Yubikey), Feitian (FIDO Key) and Google (Titan Key) are very popluar. In the most cases a user has to touch a sensor to verify his presence. They can also be shipped with biometric scanners / sensors, most commenly finger print sensors, to unlock the private key and authentication the requested action. If the authenticator is external, communication with the device takes place via USB (Universal Serial Bus), NFC (Near Field Communication) or BLE (Bluetooth Low Energy).\cite{9152694}

\subsection{Fast Identity Online 2 (FIDO2)}
The Fast Identity Online 2 (FIDO2) Project is an joint effort from the FIDO Alliance and the World Wide Web Consortium (W3C). It is an open authentication standard succeeding prior work of the FIDO Alliance on Universal 2nd Factor (U2F). \cite{9152694}  It consits of two protocols. The WebAuthn protocol, maintained by the W3C, and the Client to Authtioacation Protocol 2 (CTAP2), maintained by the FIDO Alliance. Members of the FIDO Alliance include Amazon, Google, Meta and Microsoft.

The WebAuthn protocol specifices a JavaScript-based API used for
communication between a service provider / WebAuthn relying parties (e.g. websites) and a WebAuthn client like a browser. All major browsers support WebAuthn today.\cite{000001}
The CTAP2 standardize the communication between a client and the (external) authentication device.\cite{274547}\cite{9099190}

The main idea of FIDO2 is to use public-private cryptography instead of known credentials like username and password. Furthermore, it creates a public-private keypair unique to a given application or website, which is used to sign challenges from the service and is only generated and stored on the authenticator. This is realized through a mutal authentication using a service identificator. In case of websites the authenticator recives the domain of the requesting website. Effectivley rendering phishing useless, because a relying attacker cannot provide the authenticator with the right domain.\cite{274610} Also preventing replay attacks and password theft. Tokens acquired through server breaches cannot be reverted to the original secret key on the authenticator nor can they be used to determine private keys used for other services.

To ensure quality and security the FIDO Alliance setup a metaservice which can be inquired to verify the used authenticator. The relaying party can check if the authenticator meets the FIDO Alliance standards and has no known vulnerabilities.\cite{9099190}

\section{Problems of FIDO}
While FIDO2 seems like a optimal solution, there are currently some disadvanteages, which cannot be ignored during the evaluation of the usability and usefullness of hardware security tokens.

\subsection{Misconceptions}
The study by Lassak et al.\cite{274547} about misconceptions in FIDO2 Biometric WebAuthn shows that users are not yet educated enough to understand the basic functionality of FIDO2 HSTs. There are among others misconceptions about storage location, recovery and usage of different devices. The study was held online with 42 participants from the UK and US. All of them were older than 18. The used HSTs were the participant andriod smart phone.

\paragraph{Storage Location}
The majority of the participants thought that there biometrics were sent (in an encrypted fashion) to the corresponding service provider. Only 14 participants recognized that the biometrics are stored locally and only 2 figured out that the service provider could not get there biometric data, because he is not in possession of the phone (HST).

Likewise, only 24 participants know / guessed that their biometric data are not affected in the event of a database breach on the services provider site.

Overall, only 4 participants were confident that their biometric data did not leave the phone when they used it for authentication.

\paragraph{Lost HST}
Because the private key used for authentication is stored on a phone, losing it can provide an attacker with access to the accounts. From the 42 participants 39 thought that an attacker need their biometrics for the authentication while in fact the private key can be unlocked with fallback mecanism likes PIN, pattern or password.

\paragraph{Availability}
If the unlocking of the phone via biometric fails only five participants were aware that they can unlock the HST with fallback options like PIN, pattern or password. The other participants stated that they have not setup a backup method at the service provider or they have to contact the service provider to recover their account.

\paragraph{Multiple Devices / Delegating Access}
Also, there are missconecptions concerning device sharing. One missconecption is that is possible to use another device (after registring ones biometric data). Only six participants ware aware that the login is tied to the authenticating device and that the biometric is only used to decrypt and unlock the private key for the authentication process. Transfering the private key from one authenticator to another is not intended in the current WebAuthn specifaction. If this kind of behavior is needed a roaming authenticator is needed. Furthermore, it is possible on some services to register more than one HST for a single account.

To grant a trusted person access 39 participants ansewered that it is not possible since the person would not have the required biometic data. The other participants argued that it would be possible using fallback methods or registering the biometric data of the trusted person on the HST (phone).

\paragraph{Idea of resolving this problem}
To prevent this type of misconceptions, service providers and HST manufacturers should launch an information campaign about HSTs and how they work. 
If one or both of them fail to do their job or additional advertising is needed, consideration should be given to whether government institutions, such as the BSI (German Federal Office for Information Security), should launch joint / own campaigns to inform the population about better methods of securing their accounts online.

\subsection{Downgrade Attacks}
Besides FIDO different methods of multifactor authentication exists, like One-Time-Passwords (OTP), confirmation SMS and calls and the usage of recovery codes. Commenly the user can choose between the configured MFA schemes, but expect FIDO2 none of the mention schemes is secure against real-time phishing. While reviewing Alexa's top 100 websites Ulqinaku et al. found out that most of these websites forces users to register at least one different MFA to use FIDO2 in the first place. Effecitively creating a vulnerability even when FIDO2 is used, because it undermines the security of FIDO2. Only Google with Google's Advanced Protection offers a program not relying on weak MFA, but it is opt-in and not advertised on the Google Account Dashboard.

A downgrade attack on FIDO2 can only be done if the user has different and weaker MFA registered to his account. The attacker can use this to ignore / skip the authentication via FIDO2. If an user visites a malicious website and tries a login to his account, the attacker can rely the response to victim. If the victim chooses to use FIDO2 the attacker simply ignores the response of the client and lets the user choose from a different MFA scheme, which is vulnerable to real-time phising.

The attacker has to know when and if the user has inserted his security key to continue with the authentication. Normaly the browser would present a box above the webpage containing the domain and asking for the security key, but it is also possible via API functions to detect the presence of a HST without displaying this box. The attacker can display such a box with the content he likes on his website, but this is limited to the page and is not displayed above the content. For a normal user this is not easy to spot.\cite{274610}

\subsection{Threats to HST}
While FIDO2 seems secure it relies on a secure HST. Therefor, if the HST is compromised FIDO2 is not secure anymore. An attacker can get a hold of an access token on the supply chain between a manufacturer and the end users, either by intercepting the delivery or inserting malicious HST as an manufacturer or a re-seller. An attacker can also buy genuine token and return malicious HST to the seller on refund, because most sellers won't check if the HST got tempered with. Malicious HST result in one or more of the following attack vectors: firmware modifications, hardware modifications or secret extraction. Through the firmware modification an attacker can pre-initialize an token or add malicious code which exploits e.g. USB interfaces. In hardware modification an attacker can wire the HST up with an wireless transceiver, like GSM or Bluetooth. But also he is able to build token replicas as instructions are public available and can be used without expert knowledge. The main goal of both modification is to extract secrets, e.g. keys or seeds, from the HST. This is done most commonely via falut injections, timing side-channels and bus snooping. \cite{272198} This results in the following attack scenarios.

\paragraph{Run-time secret extraction}
The run-time secret extraction can be subdivided into in-band and out-of-band attacks. In the in-band case, the HST is modified in a way that it leaks secrets through in-protocol (covert) channels like the signature or other channels used in the transcation. In the out-of-band case, the HST sends the secrets via a different covert channel outside of the protocol like Bluetooth or GSM. 

\paragraph{Delivery-time secret extraction}
An attacker can extract pre-configured keys or seeds through the above mentioned mehtods, which allows him to determine the used keys.

This attack is only releveant to HST which are shipped with pre-configured secrets by the manufcature like YubiKeys. In case of most HST but also YubiKeys these secrets can be changed by the user whenever they want.

\paragraph{Secret fixation}
Using hardware or software modifications or both an attacker can pre-load a key to the HST, which makes the key computation deterministic. 

\paragraph{Predictable RNG modifcation}
The Random Number Generator used for the secure creation of keys can be manipluliate to only create predicatable by using hardware and software modifications. In case of unintentionally weak randomness the attacker does not need to modify the token and can abuse it.

\paragraph{Ransom attack}
Like other ransom attacks, this attacks targets a denail of service. The HST is manipluliate in such a way that it stops operating after some time, demanding a ransom to resume working or release the secrets. This is attack has limited valabilty for FIDO2, since in most cases recovery codes are generated. This attack is more feasible for hardware walltes (out side of the scope of this paper).

\paragraph{USB pivoting}
On a nother node the HST can not only be used to attack logins, but also to attack the whole client via the USB interface. If the HST is equipped with malware it can act like USB Rubber Ducky (emulate a keyboard) or trigger a buffer overflow.

\paragraph{}
Pfeffer at al. present (already existing) methods to detect tempered HST.
Modifcation on hardware or firmware level can be detected with tamper-evident package using holographic stickers. But this is only a low level of protection since holographic sticker are easily replaceable and the attacker can be a manufacturer or re-seller. A HST token can be single-piece cast, like the Yubikeys, or can be opened. Single-piece cast can be easily inspected but can be breakable with household chemicales when not using more chemical resistant plastic. Openable HST can be inspected by users increasing security by visually comparing manufacturer pictures with the HST. This process has its downsides as it is error-prone and cumbersome. Siginals on the printed circuit board (PCB) are intercebteable or maniplulatable needing shielding with can be done with a secure CPU or a secure element (external co-processor). The key never leaves this secure element and therefore cannot be intercept. To prevent firmware manipluliation automatic and manual software verification can be used. In case of automatic verification it will distinguished between local and remote validation. The local validation only validates the integrity by conducting a signature check. The remote validation is a more sophisticated where the internal status is validated by a third party. Both methods needs to visible to the user otherwise the user cannot make related trust decisions.
The manual verification can only be done with some HST and the corresponding software has to be searched as it is not easily findable. Moreover, this method is neither explained nor advertised by vendors or service provides, letting uneducated users in the dark. A way to prevent attacks on pre-configured secrets is to not ship them at all and let the user generate thier secrets themselve. But manual verification and dispense of pre-configured secrets reduce the userfriendliness of HST, which can result in lower markt shares. \cite{272198}

\subsection{More Problems}
Besides the mention problems the FIDO2 standard has some other problems which are not bound to the implementation. This is highlighted in a study by Lyastani et al. \cite{9152694}

\paragraph{Account Recovery}
A fear the participants of the study had, was the losing of the HST, which means that they wont be able to access thier accounts. Currently other 2FA can be used to allow account access even when a HST fails. Some service provides allow to setup additional HST, which is recommended by the FIDO Alliance, or other 2FA schemes, which are as we showed earlier vulnerable to e.g. phishing. Only Google's Advanced Protection Program forces the user to register two HSTs.

This issues is not yet challenged by the FIDO Alliance. The current recommendation is to use additional authenticators. The authors recommend guiding the users in the task of scalable account recovery. But this won't change the fact, that account recovery is a serious issues which should be handled by the FIDO instead of single service provides to create a single way of account recovery. This problem needs attention quickly especailly when FIDO2 should become the only 2FA or even a 1FA. 

\paragraph{Account Suspension}
The authors themselve raise the concern how to revoke the HST from a account if the HST of the user is stolen. The FIDO Alliance agures that the risk of such thefts are lower than being the victim of a phishing campaign or server breach. The authors are concerend about the effect of FIDO (especially OFA) abusers in (intimate) partner violence. They are unsure if HST ease or hamper such target attacks. Also, the authors state that such behavior is not enough considered yet and that users need the possibility to lock thier account down without having the HST. An insperation can be the key revocation in PKI or GPG. 

\section{Adoption Barries}
Farke et al. explored the willingness of users to use HST in a study. Since they only had 9 participants a general statement cannot be made. But the study can show which prevent a widespreading of HST / FIDO2. The users indicated that they feared losing the HST, the additional effort to plug in the HST and the habit of using passwords.

\paragraph{Convenience}
Three participants stated that the login with a HST requires additional efforet and time, making it less convenient than using credentials like username and password. Also was perceived negatively that the setup of the HST took additional time (5 - 10 minutes). This implies that even a short duration of time can reduce the willingness to use HST.

In the study the workflow was negatively impacted, because using a HST meant that additional steps were required for each login attempt. The click count and the time to login were listed. Also it was mentioned that Windows Hello can be a hurdle for adoption, because the account selection when using multiple accounts for a single service was not clear. This may be implementation dependet but if a user has to search the right account in the HST / authentication device it can devinetly prevent spreading of FIDO2. 

The study also indicated that thought must be given to overcoming old habits and that measures must be taken to disseminate HST.

\paragraph{}
The authors mention that the participants understand the authentication process using HST and that the authentication time was more of a limiting factor. The difference in speed could be one of the primary adoption barries for FIDO2 / HST. Also, participants ansewered that unconscious decisions to use passwords instead of the HST which makes it even more difficult to change the mental mindeset of the users in general to use HST over passwords. Since only recent version of OS and clients were equipped with all WebAuthn features, WebAuthn should spread better in the future. Because it is no longer required only special software or certain knowledge and is thus better available to the general public. To overcome the mention adoption barriers the authors have the following suggestions:
\begin{itemize}
  \item Support for multiple HST (platform and roaming)
  \item Requirement of adoption of HST
  \item Implementation of FIDO2 in as many as possible services
  \item Allow to "remember" the unlock state of HST when using PIN or biometrics.
\end{itemize}
\cite{255646}
\section{Conclusion}
educate the user / population, support FIDO2 on more websites
% Start bibliography
\bibliographystyle{alpha}
\bibliography{literature}

\end{document}
