% This is samplepaper.tex, a sample chapter demonstrating the
% LLNCS macro package for Springer Computer Science proceedings;
% Version 2.20 of 2017/10/04
%
\documentclass[runningheads]{llncs}
% Add your own packages here
\usepackage{graphicx}
%
\begin{document}
%
\title{Hardware Security Tokens In Context Of FIDO2}
\subtitle{Seminar: Advances in Cryptography and IT-Security}
%
%\titlerunning{Abbreviated paper title}
% If the paper title is too long for the running head, you can set
% an abbreviated paper title here
%

\author{Robert Hartings}

\institute{
\today \\
RWTH Aachen \\
Research Group IT-Security \\[.8cm]
\begin{tabular}{rl}
  \textbf{Organizer:}& Ulrike Meyer\\
  \textbf{Supervisor:}& Vincent Drury\\
\end{tabular}
%\date{01 Apr 2019}
}
%
\maketitle              % typeset the header of the contribution
%
\begin{abstract}
The abstract should briefly summarize the contents of the paper in
150--250 words.

\end{abstract}
%
%
%
\section{Introduction}
Credentials with username and password are still the most common variant of user authentication today, despite their problems with phishing or dictionary attacks, for example. To create secure accounts, it is recommended to use strong passwords (including capital and lower letters, numbers and speical characters and a minimum length) while refraning from reuse. The user has to memorize these rather complex different passwords or use a password manager which has its own disadvanteages. If credentials are reused on multiple accounts, they are vulnerable to credential stuffing attacks, in which an attacker uses stolen credentials from one service on other services hoping for same or similar credentials, making it easier for him to guess the right combination of username/email and password. Username and password are always vulnerable to phishing, because it cannot be ruled out that even the most experienced user will make a mistake and enters thier credentials on an website owned by an attacker.

This problem is challenge by the FIDO Alliance and the W3C by providing a possible solution: The Fast Identity Online 2 (FIDO2) standard. The main difference between the proposed standard and status quo is the paradigm shift from "something a user knows" to "something a user poses". The FIDO2 standard includes a successor to the Universal 2nd Factor (U2F), which was also developed by the FIDO Alliance and, in addition to the familiar Second Factor, also offers the possibility for Single Factor Authentication, making password as we know them superfluous. The cost, inconvenience and unfamiliarity of (hardware) security keys are currently reason for thier low uptake.\cite{274547}\cite{9152694}

But like other authentication variants, FIDO2 has its own unsolved problems and drawbacks. In this paper I would like to summarize these problems and possible solutions. 

\section{Background}
\subsection{Hardware Secruity Tokens (HSTs)}
HSTs are used to securly store a secret key used for cryptographic functions in a tamper-resistant storage. The main idea is that the secret never leaves the secure storage. The secret key is used for deriving subsequent authentication keys for creation of public / private identities. The derived keys are mainly used to sign recived challenges, but can also be used to identiy a user.\cite{272198}

HST, also called authenticators, can be so called security keys but also integrated authenticators including Trusted Platform Module (TPM), Andriod keystore and Apple TouchID. Microsoft Hello is one example for the TPM.

Security keys from vendors like Yubico (Yubikey), Feitian (FIDO Key) and Google (Titan Key) are very popluar. In the most cases a user has to touch a sensor to verify his presence. They can also be shipped with biometric scanners / sensors, most commenly finger print sensors, to unlock the private key and authentication the requested action. If the authenticator is external, communication with the device takes place via USB (Universal Serial Bus), NFC (Near Field Communication) or BLE (Bluetooth Low Energy).\cite{9152694}

\subsection{Fast Identity Online 2 (FIDO2)}
The Fast Identity Online 2 (FIDO2) Project is an joint effort from the FIDO Alliance and the World Wide Web Consortium (W3C). It is an open authentication standard succeeding prior work of the FIDO Alliance on Universal 2nd Factor (U2F). \cite{9152694}  It consits of two protocols. The WebAuthn protocol, maintained by the W3C, and the Client to Authtioacation Protocol 2 (CTAP2), maintained by the FIDO Alliance. Members of the FIDO Alliance include Amazon, Google, Meta and Microsoft.

The WebAuthn protocol specifices a JavaScript-based API used for
communication between a service provider / WebAuthn relying parties (e.g. websites) and a WebAuthn client like a browser. All major browsers support WebAuthn today.\cite{000001}
The CTAP2 standardize the communication between a client and the (external) authentication device.\cite{274547}\cite{9099190}

The main idea of FIDO2 is to use public-private cryptography instead of known credentials like username and password. Furthermore, it creates a public-private keypair unique to a given application or website, which is used to sign challenges from the service and is only generated and stored on the authenticator. This is realized through a mutal authentication using a service identificator. In case of websites the authenticator recives the domain of the requesting website. Effectivley rendering phishing useless, because a relying attacker cannot provide the authenticator with the right domain.\cite{274610} Also preventing replay attacks and password theft. Tokens acquired through server breaches cannot be reverted to the original secret key on the authenticator nor can they be used to determine private keys used for other services.

To ensure quality and security the FIDO Alliance setup a metaservice which can be inquired to verify the used authenticator. The relaying party can check if the authenticator meets the FIDO Alliance standards and has no known vulnerabilities.\cite{9099190}

\section{Problems of FIDO}
While FIDO2 seems like a optimal solution, there are currently some disadvanteages, which cannot be ignored during the evaluation of the usability and usefullness of hardware security tokens.

\subsection{Misconceptions}
The study by Lassak et al.\cite{274547} about misconceptions in FIDO2 Biometric WebAuthn shows that users are not yet educated enough to understand the basic functionality of FIDO2 HSTs. There are among others misconceptions about storage location, recovery and usage of different devices. The study was held online with 42 participants from the UK and US. All of them were older than 18. The used HSTs were the participant andriod smart phone.

\paragraph{Storage Location}
The majority of the participants thought that there biometrics were sent (in an encrypted fashion) to the corresponding service provider. Only 14 participants recognized that the biometrics are stored locally and only 2 figured out that the service provider could not get there biometric data, because he is not in possession of the phone (HST).

Likewise, only 24 participants know / guessed that their biometric data are not affected in the event of a database breach on the services provider site.

Overall, only 4 participants were confident that their biometric data did not leave the phone when they used it for authentication.

\paragraph{Lost HST}
Because the private key used for authentication is stored on a phone, losing it can provide an attacker with access to the accounts. From the 42 participants 39 thought that an attacker need their biometrics for the authentication while in fact the private key can be unlocked with fallback mecanism likes PIN, pattern or password.

\paragraph{Availability}
If the unlocking of the phone via biometric fails only five participants were aware that they can unlock the HST with fallback options like PIN, pattern or password. The other participants stated that they have not setup a backup method at the service provider or they have to contact the service provider to recover their account.

\paragraph{Multiple Devices / Delegating Access}
Also, there are missconecptions concerning device sharing. One missconecption is that is possible to use another device (after registring ones biometric data). Only six participants ware aware that the login is tied to the authenticating device and that the biometric is only used to decrypt and unlock the private key for the authentication process. Transfering the private key from one authenticator to another is not intended in the current WebAuthn specifaction. If this kind of behavior is needed a roaming authenticator is needed. Furthermore, it is possible on some services to register more than one HST for a single account.

To grant a trusted person access 39 participants ansewered that it is not possible since the person would not have the required biometic data. The other participants argued that it would be possible using fallback methods or registering the biometric data of the trusted person on the HST (phone).

\paragraph{Idea of resolving this problem}
To prevent this type of misconceptions, service providers and HST manufacturers should launch an information campaign about HSTs and how they work. 
If one or both of them fail to do their job or additional advertising is needed, consideration should be given to whether government institutions, such as the BSI (German Federal Office for Information Security), should launch joint / own campaigns to inform the population about better methods of securing their accounts online.

\subsection{Threats to OFA FIDO2}
FIDO2 allows the usage of a hardware security key as a single factor (OFA / SFA) or a multi factor (MFA).

\subsection{Downgrade Attacks}

\subsection{Distribution}

\subsection{Convenience}

\section{Conclusion}

% Start bibliography
\bibliographystyle{alpha}
\bibliography{literature}

\end{document}
